{"version":3,"mappings":"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","names":["projects","__vitePreload","menu","canvas","backButton","projectList","currentDispose","buildMenu","key","project","card","e","loadProject","video","setupScrollVisibility","cards","visibilityMap","updateVisibleCard","bestCard","bestRatio","ratio","isVisible","observer","entries","entry","listRect","cardRect","overlap","cleanCurrentProject","showMenu","projectKey","urlParams"],"ignoreList":[],"sources":["../../src/main.js"],"sourcesContent":["import './style.css'\n\nconst projects = {\n  'haunted-house': {\n    name: 'Haunted House',\n    description: 'Une maison hantée avec fantômes, ombres et brouillard',\n    image: './screen/haunted_house.png',\n    video: './screen/video/haunted_house.mp4',\n    load: () => import('./projects/haunted-house.js'),\n  },\n  particles: {\n    name: 'Particles',\n    description: 'Expérimentations avec des systèmes de particules',\n    image: './screen/particles.png',\n    video: './screen/video/particles.mp4',\n    load: () => import('./projects/particles.js'),\n  },\n  'galaxy-generator': {\n    name: 'Galaxy Generator',\n    description: 'Un générateur de galaxies avec des particules',\n    image: './screen/galaxy.png',\n    video: './screen/video/galaxy.mp4',\n    load: () => import('./projects/galaxy-generator.js'),\n  },\n  'scroll-animation': {\n    name: 'Scroll Animation',\n    description: 'Animation synchronisée au scroll en webgl',\n    image: './screen/scroll_animation.png',\n    video: './screen/video/scroll_animation.mp4',\n    load: () => import('./projects/scroll-animation.js'),\n  },\n}\n\n// DOM elements\nconst menu = document.getElementById('menu')\nconst canvas = document.querySelector('canvas.webgl')\nconst backButton = document.getElementById('back-button')\nconst projectList = document.getElementById('project-list')\n\n/**\n * current project dispose\n */\nlet currentDispose = null\n\n/**\n * build menu dynamically\n */\nconst buildMenu = () => {\n  projectList.innerHTML = ''\n\n  for (const [key, project] of Object.entries(projects).reverse()) {\n    const card = document.createElement('a')\n    card.href = `?project=${key}`\n    card.className = 'project-card'\n    card.addEventListener('click', (e) => {\n      e.preventDefault()\n      loadProject(key)\n    })\n\n    card.innerHTML = `\n      <div class=\"project-card-media\">\n        ${project.image ? `<img src=\"${project.image}\" alt=\"${project.name}\" />` : ''}\n        ${project.video ? `<video src=\"${project.video}\" muted loop playsinline preload=\"none\"></video>` : ''}\n      </div>\n      <div class=\"project-card-content\">\n        <h2>${project.name}</h2>\n        <p>${project.description}</p>\n      </div>\n    `\n\n    // Hover video play/pause (desktop)\n    if (project.video) {\n      const video = card.querySelector('video')\n      if (video) {\n        card.addEventListener('mouseenter', () => {\n          video.currentTime = 0\n          video.play().catch(() => {})\n        })\n        card.addEventListener('mouseleave', () => {\n          video.pause()\n        })\n      }\n    }\n\n    projectList.appendChild(card)\n  }\n\n  setupScrollVisibility()\n}\n\n/**\n * On mobile: detect visible card on scroll, add selection border and play video\n */\nfunction setupScrollVisibility() {\n  const isMobile = window.matchMedia('(max-width: 768px)').matches\n  if (!isMobile) return\n\n  const cards = projectList.querySelectorAll('.project-card')\n\n  const visibilityMap = new Map()\n\n  const updateVisibleCard = () => {\n    let bestCard = null\n    let bestRatio = 0\n    for (const [card, ratio] of visibilityMap) {\n      if (ratio > bestRatio) {\n        bestRatio = ratio\n        bestCard = card\n      }\n    }\n\n    cards.forEach((card) => {\n      const video = card.querySelector('video')\n      const isVisible = card === bestCard && bestRatio > 0.3\n      card.classList.toggle('is-visible', isVisible)\n      if (video) {\n        if (isVisible) {\n          video.currentTime = 0\n          video.play().catch(() => {})\n        } else {\n          video.pause()\n        }\n      }\n    })\n  }\n\n  const observer = new IntersectionObserver(\n    (entries) => {\n      for (const entry of entries) {\n        visibilityMap.set(entry.target, entry.intersectionRatio)\n      }\n      updateVisibleCard()\n    },\n    {\n      root: projectList,\n      threshold: [0, 0.25, 0.5, 0.75, 1],\n      rootMargin: '0px',\n    },\n  )\n\n  cards.forEach((card) => observer.observe(card))\n\n  // Initial check (observer callback may be async)\n  requestAnimationFrame(() => {\n    cards.forEach((card) => {\n      const listRect = projectList.getBoundingClientRect()\n      const cardRect = card.getBoundingClientRect()\n      const overlap = Math.max(\n        0,\n        Math.min(cardRect.right, listRect.right) -\n          Math.max(cardRect.left, listRect.left),\n      )\n      visibilityMap.set(card, overlap / cardRect.width)\n    })\n    updateVisibleCard()\n  })\n}\n\nconst cleanCurrentProject = () => {\n  if (currentDispose) {\n    currentDispose()\n    currentDispose = null\n  }\n}\n\n// load project\nasync function loadProject(key) {\n  cleanCurrentProject()\n\n  // update url without reloading the page\n  window.history.pushState({}, '', `?project=${key}`)\n\n  // hide menu, show canvas and back button\n  menu.style.display = 'none'\n  canvas.style.display = 'block'\n  backButton.style.display = 'flex'\n\n  // load project module dynamically\n  const module = await projects[key].load()\n  currentDispose = module.default(canvas)\n}\n\n// back to menu\nfunction showMenu() {\n  cleanCurrentProject()\n\n  // update url without reloading the page\n  window.history.pushState({}, '', window.location.pathname)\n\n  // show menu, hide canvas and back button\n  menu.style.display = 'flex'\n  canvas.style.display = 'none'\n  backButton.style.display = 'none'\n}\n\n// events\nbackButton.addEventListener('click', showMenu)\n\n// handle back button of the browser\nwindow.addEventListener('popstate', () => {\n  const urlParams = new URLSearchParams(window.location.search)\n  const projectKey = urlParams.get('project')\n\n  if (projectKey && projects[projectKey]) {\n    loadProject(projectKey)\n  } else {\n    showMenu()\n  }\n})\n\n// initialize\nbuildMenu()\n\nconst urlParams = new URLSearchParams(window.location.search)\nconst projectKey = urlParams.get('project')\n\nif (projectKey && projects[projectKey]) {\n  loadProject(projectKey)\n} else {\n  // show menu\n  menu.style.display = 'flex'\n  canvas.style.display = 'none'\n  backButton.style.display = 'none'\n}\n"],"file":"assets/index-BCD_6fLP.js"}